<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MD Caps and Clothing - Select Kaptan</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@600&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
<style>
/* ====== Your styles remain unchanged (with small a11y/perf tweaks) ====== */
body {
  margin:0; padding:0; font-family:'Poppins',sans-serif; background:#0d1117; color:#fff;
}
.top-bar {
  display:flex; justify-content:space-between; align-items:center; padding:8px 15px;
}
.top-bar .home{
  cursor:pointer; font-size:16px; font-weight:bold;
}
.top-bar .resume{
  font-size:12px; background:#ff6600; padding:5px 12px; 
  border-radius:6px; text-align:center; display:none; 
  position:relative; cursor:pointer;
}
.top-bar .resume .closeBtn{
  margin-left:8px; font-size:14px; font-weight:bold; cursor:pointer; 
}
h1.glow{
  text-align:center; font-family:'Playfair Display', serif; font-size:2rem; color:#ffcc00;
  text-shadow: 0 0 5px #fff, 0 0 10px #ffcc00, 0 0 20px #ffcc00, 0 0 30px #ffcc00;
  margin-top:10px; margin-bottom:5px;
}
h3.subtext{
  text-align:center; font-size:12px; margin-bottom:20px;
}
.gallery {
  display:flex; flex-direction:column; gap:15px; padding:10px 5px; align-items:center;
}
.item {
  position:relative; border:1px solid #ff6600; border-radius:10px; overflow:hidden; width:180px;
}
.item img{
  width:100%; border-radius:10px; cursor:pointer; display:block;
}
.item .prices{
  padding:5px 0; font-size:12px; text-align:center; background:rgba(0,0,0,.6);
}
.item button.buyBtn{
  width:100%; padding:8px; margin-bottom:5px; background:#00f7ff; border:none; border-radius:6px; cursor:pointer; font-weight:bold;
}
.item button.buyBtn:hover{background:#00cbd1;}
/* Popups */
.popup {
  display:none; position:fixed; top:0; left:0; right:0; bottom:0;
  background:rgba(0,0,0,.8); justify-content:center; align-items:center; z-index:20000;
}
.popup-content{
  background:#161b22; padding:20px; border-radius:15px; text-align:center; width:80%; max-width:300px; position:relative;
}
.popup-content .closeBtn{
  position:absolute; top:5px; right:10px; cursor:pointer; font-weight:bold; font-size:18px; color:#fff;
}
.full-img {
  display:none; position:fixed; top:0; left:0; right:0; bottom:0; background:rgba(0,0,0,.9); justify-content:center; align-items:center; z-index:30000;
}
.full-img img{ max-width:90%; max-height:90%; border-radius:10px; }
.full-img .backIcon{
  position:absolute; top:15px; right:20px; font-size:25px; cursor:pointer; color:#fff;
}
/* Buy popup buttons */
.popup-content button.optionBtn{
  width:80%; margin:8px 0; padding:8px; border:none; border-radius:6px; cursor:pointer; font-weight:bold;
}
.shortBtn{background:#4CAF50; color:#fff;}
.longBtn{background:#e63946; color:#fff;}
.shortBtn:hover{opacity:0.85;}
.longBtn:hover{opacity:0.85;}
/* Footer message */
.footer {
  text-align:center; font-size:13px; padding:15px; margin-top:30px; background:#161b22; border-top:1px solid #333;
}
.footer a{color:#00f7ff; text-decoration:none; font-weight:bold;}
</style>

<!-- Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-76JLHFZVDQ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-76JLHFZVDQ');
</script>
</head>
<body>

<div class="top-bar">
  <div class="home" onclick="goHome()">üè° Home</div>
  <div class="resume" id="resumeOrder" onclick="continueOrder()">
    Continue Your Order 
    <span class="closeBtn" onclick="closeResume(event)">&times;</span>
  </div>
</div>

<h1 class="glow">SELECT YOUR KAPTAN DESIGN</h1>
<h3 class="subtext">Choose between short (short sleeve) or long (long sleeve). Prices vary based on style.</h3>

<div class="gallery">
  <!-- ===== Keep your original 4 items ===== -->
  <div class="item">
    <img src="https://i.imgur.com/fsdYxPK.jpeg" alt="Kaptan design" loading="lazy" onclick="openFull(this)">
    <div class="prices">Short: 20k | Long: 25k</div>
    <button class="buyBtn" onclick="buyPopup(this.parentElement.querySelector('img'))">Buy This</button>
  </div>
  <div class="item">
    <img src="https://i.imgur.com/PJ1LnvI.jpeg" alt="Kaptan design" loading="lazy" onclick="openFull(this)">
    <div class="prices">Short: 20k | Long: 25k</div>
    <button class="buyBtn" onclick="buyPopup(this.parentElement.querySelector('img'))">Buy This</button>
  </div>
  <div class="item">
    <img src="https://i.imgur.com/nZgbZfT.jpeg" alt="Kaptan design" loading="lazy" onclick="openFull(this)">
    <div class="prices">Short: 20k | Long: 25k</div>
    <button class="buyBtn" onclick="buyPopup(this.parentElement.querySelector('img'))">Buy This</button>
  </div>
  <div class="item">
    <img src="https://i.imgur.com/pa977uJ.jpeg" alt="Kaptan design" loading="lazy" onclick="openFull(this)">
    <div class="prices">Short: 20k | Long: 25k</div>
    <button class="buyBtn" onclick="buyPopup(this.parentElement.querySelector('img'))">Buy This</button>
  </div>

  <!-- ===== New Group 1 (25k/20k) ===== -->
  <div class="item"><img src="https://i.imgur.com/FYR1WTJ.jpeg" alt="Kaptan design" loading="lazy" onclick="openFull(this)"><div class="prices">Short: 20k | Long: 25k</div><button class="buyBtn" onclick="buyPopup(this.parentElement.querySelector('img'))">Buy This</button></div>
  <div class="item"><img src="https://i.imgur.com/NyQJ6oF.jpeg" alt="Kaptan design" loading="lazy" onclick="openFull(this)"><div class="prices">Short: 20k | Long: 25k</div><button class="buyBtn" onclick="buyPopup(this.parentElement.querySelector('img'))">Buy This</button></div>
  <div class="item"><img src="https://i.imgur.com/D2Ad3x4.jpeg" alt="Kaptan design" loading="lazy" onclick="openFull(this)"><div class="prices">Short: 20k | Long: 25k</div><button class="buyBtn" onclick="buyPopup(this.parentElement.querySelector('img'))">Buy This</button></div>
  <div class="item"><img src="https://i.imgur.com/pKYZmdb.jpeg" alt="Kaptan design" loading="lazy" onclick="openFull(this)"><div class="prices">Short: 20k | Long: 25k</div><button class="buyBtn" onclick="buyPopup(this.parentElement.querySelector('img'))">Buy This</button></div>
  <div class="item"><img src="https://i.imgur.com/c8dZrhp.jpeg" alt="Kaptan design" loading="lazy" onclick="openFull(this)"><div class="prices">Short: 20k | Long: 25k</div><button class="buyBtn" onclick="buyPopup(this.parentElement.querySelector('img'))">Buy This</button></div>
  <div class="item"><img src="https://i.imgur.com/ES2L878.jpeg" alt="Kaptan design" loading="lazy" onclick="openFull(this)"><div class="prices">Short: 20k | Long: 25k</div><button class="buyBtn" onclick="buyPopup(this.parentElement.querySelector('img'))">Buy This</button></div>

  <!-- ===== New Group 2 (25k/20k) ===== -->
  <div class="item"><img src="https://i.imgur.com/N8pFXuw.jpeg" alt="Kaptan design" loading="lazy" onclick="openFull(this)"><div class="prices">Short: 20k | Long: 25k</div><button class="buyBtn" onclick="buyPopup(this.parentElement.querySelector('img'))">Buy This</button></div>
  <div class="item"><img src="https://i.imgur.com/fGR07Yb.jpeg" alt="Kaptan design" loading="lazy" onclick="openFull(this)"><div class="prices">Short: 20k | Long: 25k</div><button class="buyBtn" onclick="buyPopup(this.parentElement.querySelector('img'))">Buy This</button></div>
  <div class="item"><img src="https://i.imgur.com/zNFZnyU.jpeg" alt="Kaptan design" loading="lazy" onclick="openFull(this)"><div class="prices">Short: 20k | Long: 25k</div><button class="buyBtn" onclick="buyPopup(this.parentElement.querySelector('img'))">Buy This</button></div>
  <div class="item"><img src="https://i.imgur.com/WMPnozi.jpeg" alt="Kaptan design" loading="lazy" onclick="openFull(this)"><div class="prices">Short: 20k | Long: 25k</div><button class="buyBtn" onclick="buyPopup(this.parentElement.querySelector('img'))">Buy This</button></div>
  <div class="item"><img src="https://i.imgur.com/XCkBqyq.jpeg" alt="Kaptan design" loading="lazy" onclick="openFull(this)"><div class="prices">Short: 20k | Long: 25k</div><button class="buyBtn" onclick="buyPopup(this.parentElement.querySelector('img'))">Buy This</button></div>
  <div class="item"><img src="https://i.imgur.com/8UFOt2B.jpeg" alt="Kaptan design" loading="lazy" onclick="openFull(this)"><div class="prices">Short: 20k | Long: 25k</div><button class="buyBtn" onclick="buyPopup(this.parentElement.querySelector('img'))">Buy This</button></div>
  <div class="item"><img src="https://i.imgur.com/38AevD5.jpeg" alt="Kaptan design" loading="lazy" onclick="openFull(this)"><div class="prices">Short: 20k | Long: 25k</div><button class="buyBtn" onclick="buyPopup(this.parentElement.querySelector('img'))">Buy This</button></div>

  <!-- ===== New Group 3 (25k/20k) ===== -->
  <div class="item"><img src="https://i.imgur.com/72prNqt.jpeg" alt="Kaptan design" loading="lazy" onclick="openFull(this)"><div class="prices">Short: 20k | Long: 25k</div><button class="buyBtn" onclick="buyPopup(this.parentElement.querySelector('img'))">Buy This</button></div>
  <div class="item"><img src="https://i.imgur.com/wUHIw2a.jpeg" alt="Kaptan design" loading="lazy" onclick="openFull(this)"><div class="prices">Short: 20k | Long: 25k</div><button class="buyBtn" onclick="buyPopup(this.parentElement.querySelector('img'))">Buy This</button></div>
  <div class="item"><img src="https://i.imgur.com/CUPoMgY.jpeg" alt="Kaptan design" loading="lazy" onclick="openFull(this)"><div class="prices">Short: 20k | Long: 25k</div><button class="buyBtn" onclick="buyPopup(this.parentElement.querySelector('img'))">Buy This</button></div>
  <div class="item"><img src="https://i.imgur.com/rBmS3QW.jpeg" alt="Kaptan design" loading="lazy" onclick="openFull(this)"><div class="prices">Short: 20k | Long: 25k</div><button class="buyBtn" onclick="buyPopup(this.parentElement.querySelector('img'))">Buy This</button></div>
  <div class="item"><img src="https://i.imgur.com/kz1WBoF.jpeg" alt="Kaptan design" loading="lazy" onclick="openFull(this)"><div class="prices">Short: 20k | Long: 25k</div><button class="buyBtn" onclick="buyPopup(this.parentElement.querySelector('img'))">Buy This</button></div>
  <div class="item"><img src="https://i.imgur.com/dIPts0g.jpeg" alt="Kaptan design" loading="lazy" onclick="openFull(this)"><div class="prices">Short: 20k | Long: 25k</div><button class="buyBtn" onclick="buyPopup(this.parentElement.querySelector('img'))">Buy This</button></div>
  <div class="item"><img src="https://i.imgur.com/IKZG8Dt.jpeg" alt="Kaptan design" loading="lazy" onclick="openFull(this)"><div class="prices">Short: 20k | Long: 25k</div><button class="buyBtn" onclick="buyPopup(this.parentElement.querySelector('img'))">Buy This</button></div>

  <!-- ===== New Group 4 (18k) ===== -->
  <div class="item"><img src="https://i.imgur.com/gKblrBD.jpeg" alt="Kaptan design" loading="lazy" onclick="openFull(this)"><div class="prices">18k</div><button class="buyBtn" onclick="buyPopup(this.parentElement.querySelector('img'))">Buy This</button></div>
  <div class="item"><img src="https://i.imgur.com/V7KW32J.jpeg" alt="Kaptan design" loading="lazy" onclick="openFull(this)"><div class="prices">18k</div><button class="buyBtn" onclick="buyPopup(this.parentElement.querySelector('img'))">Buy This</button></div>
  <div class="item"><img src="https://i.imgur.com/j7nNDN8.jpeg" alt="Kaptan design" loading="lazy" onclick="openFull(this)"><div class="prices">18k</div><button class="buyBtn" onclick="buyPopup(this.parentElement.querySelector('img'))">Buy This</button></div>
  <div class="item"><img src="https://i.imgur.com/8rcURfB.jpeg" alt="Kaptan design" loading="lazy" onclick="openFull(this)"><div class="prices">18k</div><button class="buyBtn" onclick="buyPopup(this.parentElement.querySelector('img'))">Buy This</button></div>
  <div class="item"><img src="https://i.imgur.com/xpQVRTA.jpeg" alt="Kaptan design" loading="lazy" onclick="openFull(this)"><div class="prices">18k</div><button class="buyBtn" onclick="buyPopup(this.parentElement.querySelector('img'))">Buy This</button></div>
</div>

<!-- Full Image View -->
<div class="full-img" id="fullImgPopup">
  <span class="backIcon" role="button" tabindex="0" aria-label="Close full image" onclick="closeFull()">&times;</span>
  <img id="fullImg" src="" alt="Full view">
</div>

<!-- Buy Popup -->
<div class="popup" id="buyPopup">
  <div class="popup-content">
    <span class="closeBtn" role="button" tabindex="0" aria-label="Close options" onclick="closeBuy()">&times;</span>
    <h3>Choose Option</h3>
    <button class="optionBtn shortBtn" onclick="selectOption('short')">Short Sleeve</button>
    <button class="optionBtn longBtn" onclick="selectOption('long')">Long Sleeve</button>
  </div>
</div>

<!-- Footer message -->
<div class="footer">
  Didn't get any style? <a href="https://wa.me/2348149608006" target="_blank" rel="noopener noreferrer">Send your style</a>
</div>

<script>
let selectedImg = "";
let selectedPriceShort = 0;
let selectedPriceLong = 0;

// ===== Full Image =====
function openFull(img){
  document.getElementById("fullImg").src = img.src;
  document.getElementById("fullImgPopup").style.display = "flex";
  document.body.style.overflow = 'hidden';
  gtag('event', 'view_image', { 'event_category': 'Gallery','event_label': img.src });
}
function closeFull(){ document.getElementById("fullImgPopup").style.display = "none"; document.body.style.overflow = ''; }

// ===== Buy Popup =====
function buyPopup(imgElement){
  selectedImg = imgElement.src;
  const parentItem = imgElement.closest('.item');
  const pricesText = parentItem.querySelector('.prices').innerText;
  parsePrices(pricesText);
  updatePopupButtonDynamically();
  document.getElementById("buyPopup").style.display = "flex";
  document.body.style.overflow = 'hidden';
  gtag('event', 'click_buy', {'event_category':'Order','event_label':selectedImg});
}
function closeBuy(){ document.getElementById("buyPopup").style.display = "none"; document.body.style.overflow = ''; }

// ===== Parse Prices (supports `k` suffix, commas, and single-price) =====
function parsePrices(pricesText){
  const clean = pricesText.replace(/[,‚Ç¶]/g, '');
  const shortMatch = clean.match(/Short:\s*(\d+)\s*(k)?/i);
  const longMatch  = clean.match(/Long:\s*(\d+)\s*(k)?/i);
  if(shortMatch){
    const value = parseInt(shortMatch[1], 10);
    selectedPriceShort = isNaN(value) ? 0 : value * (shortMatch[2] ? 1000 : 1);
  } else { selectedPriceShort = 0; }
  if(longMatch){
    const value = parseInt(longMatch[1], 10);
    selectedPriceLong = isNaN(value) ? 0 : value * (longMatch[2] ? 1000 : 1);
  } else { selectedPriceLong = 0; }
  if(!shortMatch && !longMatch){
    const singleMatch = clean.match(/(\d+)\s*(k)?/i);
    if(singleMatch){
      const value = parseInt(singleMatch[1], 10);
      const naira = isNaN(value) ? 0 : value * (singleMatch[2] ? 1000 : 1);
      selectedPriceShort = naira;
      selectedPriceLong  = naira;
    } else {
      selectedPriceShort = selectedPriceLong = 0;
    }
  }
}

function formatNaira(n){ try { return '‚Ç¶' + Number(n||0).toLocaleString('en-NG'); } catch(e){ return '‚Ç¶' + (n||0); } }
// ===== Update Popup Buttons =====
function updatePopupButtonDynamically(){
  const shortBtn = document.querySelector('.popup-content .shortBtn');
  const longBtn = document.querySelector('.popup-content .longBtn');
  if(shortBtn) shortBtn.innerText = `Short Sleeve - ${formatNaira(selectedPriceShort)}`;
  if(longBtn) longBtn.innerText = `Long Sleeve - ${formatNaira(selectedPriceLong)}`;
}

// ===== Select Option and Save =====
function selectOption(option){
  const price = option === "short" ? selectedPriceShort : selectedPriceLong;
  const order = { image: selectedImg, option: option, price: price, step: "payment" };
  localStorage.setItem("order", JSON.stringify(order));
  closeBuy();
  // ‚úÖ Pass URL + price to payment.html (amount in Naira)
  window.location.href = `payment.html?design=${encodeURIComponent(selectedImg)}&amount=${encodeURIComponent(price)}`;
  gtag('event', 'select_option', { 'event_category':'Order','event_label':option });
}

// ===== Continue Order =====
function continueOrder(){
  gtag('event','continue_order',{'event_category':'Order'});
  const order = JSON.parse(localStorage.getItem("order"));
  if(order){
    if(order.step==="payment"){ window.location.href="payment.html"; }
    else if(order.step==="measurement"){ window.location.href="measurement.html"; }
    else { window.location.href="payment.html"; }
  } else { alert("No previous order found."); }
}

// ===== Cancel Resume Button =====
function closeResume(event){
  event.stopPropagation();
  document.getElementById("resumeOrder").style.display="none";
}

// ===== Show Resume Button and backdrop/ESC handlers =====
window.onload = function(){
  if(localStorage.getItem("order")){
    document.getElementById("resumeOrder").style.display="inline-block";
  }
  // Backdrop click to close popups
  var fullImgPopup = document.getElementById('fullImgPopup');
  if(fullImgPopup){ fullImgPopup.addEventListener('click', function(e){ if(e.target === fullImgPopup){ closeFull(); } }); }
  var buyOverlay = document.getElementById('buyPopup');
  if(buyOverlay){ buyOverlay.addEventListener('click', function(e){ if(e.target === buyOverlay){ closeBuy(); } }); }
};

// ===== Home Button =====
function goHome(){
  gtag('event','go_home',{'event_category':'Navigation'});
  window.location.href="index.html"; // ‚úÖ Ensure home works
}

// ===== Keyboard accessibility (ESC to close, Enter/Space on close icons) =====
document.addEventListener('keydown', function(e){
  if(e.key === 'Escape'){
    closeFull();
    closeBuy();
  }
});
document.querySelectorAll('.closeBtn, .backIcon').forEach(function(el){
  el.setAttribute('role','button');
  el.setAttribute('tabindex','0');
  el.addEventListener('keydown', function(e){ if(e.key === 'Enter' || e.key === ' '){ e.preventDefault(); el.click(); } });
});
</script>

</body>
</html>